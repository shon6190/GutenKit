{"version":3,"file":"editor-app.js","mappings":"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","sources":["webpack://block-factory-blocks/./src/editor-app.js"],"sourcesContent":["/**\r\n * Editor Application for defining block components.\r\n */\r\nconst { useState, useEffect, createElement } = wp.element;\r\nconst { Button, TextControl, Panel, PanelBody, SelectControl } = wp.components;\r\n\r\n// Define the available field types (your component palette)\r\nconst FIELD_TYPES = [\r\n    { label: 'Text Input', value: 'text' },\r\n    { label: 'Number Input', value: 'number' },\r\n    { label: 'Range Slider', value: 'range' }, // New\r\n    // { label: 'Email Address', value: 'email' }, // New (uses TextControl)\r\n    { label: 'URL Link', value: 'url' },       // New (uses URLInput or TextControl)\r\n    \r\n    { label: 'Text Area', value: 'textarea' },\r\n    { label: 'Rich Text Content', value: 'contentEditor' }, // Existing/Renamed (WYSIWYG)\r\n    \r\n    { label: 'Image/Media', value: 'image' },\r\n    { label: 'File Upload', value: 'file' }, // New (uses MediaUpload)\r\n    { label: 'Gallery', value: 'gallery' }, // New (complex, placeholder added)\r\n    \r\n    { label: 'Date Picker', value: 'date' },\r\n    { label: 'Date Time Picker', value: 'datetime' }, // New\r\n    { label: 'Time Picker', value: 'time' },         // New\r\n    \r\n    { label: 'Color Picker', value: 'color' },\r\n    { label: 'Icon Picker', value: 'icon' }, // New (Placeholder)\r\n    \r\n    { label: 'Repeater/Group', value: 'repeater' }, // Complex, requires nested fields\r\n    { label: 'Relational (Post Select)', value: 'relational' }, // Complex, placeholder added\r\n];\r\n\r\n// --- NEW CODE ADDED HERE (Utility Function) ---\r\nconst slugifyKey = (value) => value.toLowerCase().replace(/[^a-z0-9_]/g, '');\r\n\r\n// --- 1. The Main Application Component ---\r\nconst ComponentEditorApp = ({ initialConfig, blockSlug }) => {\r\n    // State to hold the array of fields (the component structure)\r\n    const [fields, setFields] = useState(initialConfig.fields || []);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [selectedField, setSelectedField] = useState(null); // Field being edited\r\n    const [message, setMessage] = useState('');\r\n\r\n    // --- Helper function to add a new field ---\r\n    const addField = (type) => {\r\n        const newField = {\r\n            type: type,\r\n            key: `new_field_${fields.length}`,\r\n            label: `New ${type} Field`,\r\n            default: '',\r\n        };\r\n        setFields([...fields, newField]);\r\n        setSelectedField(newField); // Automatically select the new field for editing\r\n    };\r\n\r\n    // --- Helper function to update a field's properties ---\r\n    const updateField = (index, property, value) => {\r\n        const newFields = fields.map((field, i) => {\r\n            if (i === index) {\r\n                // Ensure key is slugified\r\n                if (property === 'key') {\r\n                    value = value.toLowerCase().replace(/[^a-z0-9_]/g, '');\r\n                }\r\n                return { ...field, [property]: value };\r\n            }\r\n            return field;\r\n        });\r\n        setFields(newFields);\r\n        // Also update the selected field reference if it's the one being edited\r\n        setSelectedField(newFields[index]); \r\n    };\r\n\r\n    // --- Helper function to remove a field ---\r\n    const removeField = (index) => {\r\n        setFields(fields.filter((_, i) => i !== index));\r\n        setSelectedField(null);\r\n    };\r\n\r\n    // --- AJAX Save Handler ---\r\n    const handleSave = () => {\r\n        setIsSaving(true);\r\n        setMessage('');\r\n\r\n        const data = {\r\n            action: 'block_factory_save_structure',\r\n            nonce: blockFactoryEditorData.nonce, // Retrieve nonce from PHP\r\n            block_slug: blockSlug,\r\n            config_data: JSON.stringify({ fields }),\r\n        };\r\n\r\n        // Use standard jQuery/fetch for AJAX submission\r\n        jQuery.post(ajaxurl, data)\r\n            .done(response => {\r\n                if (response.success) {\r\n                    setMessage(`✅ Success! ${response.data.message} ${response.data.next_step}`);\r\n                } else {\r\n                    setMessage(`❌ Error: ${response.data.message}`);\r\n                }\r\n            })\r\n            .fail(() => {\r\n                setMessage('❌ Critical Error: Could not reach the server.');\r\n            })\r\n            .always(() => {\r\n                setIsSaving(false);\r\n            });\r\n    };\r\n\r\n\r\n    // --- NEW CODE ADDED HERE (Repeater Renderer) ---\r\n    const renderRepeaterSettings = (field, fieldIndex, updateFieldProp, removeFieldAtIndex) => {\r\n        // Initialize the subFields array if it doesn't exist\r\n        const subFields = field.subFields || [];\r\n\r\n        // Function to add a new sub-field to the repeater\r\n        const addSubField = (type) => {\r\n            const newSubField = {\r\n                type: type,\r\n                key: slugifyKey(`sub_field_${subFields.length}_${type}`),\r\n                label: `New ${type} Sub-Field`,\r\n                default: '',\r\n            };\r\n            // Update the main field's subFields property\r\n            updateFieldProp(fieldIndex, 'subFields', [...subFields, newSubField]);\r\n        };\r\n\r\n        // Function to update a sub-field's properties\r\n        const updateSubField = (subIndex, property, value) => {\r\n            const newSubFields = subFields.map((subField, i) => {\r\n                if (i === subIndex) {\r\n                    // Ensure key is slugified for the sub-field\r\n                    if (property === 'key') {\r\n                        value = slugifyKey(value);\r\n                    }\r\n                    return { ...subField, [property]: value };\r\n                }\r\n                return subField;\r\n            });\r\n            updateFieldProp(fieldIndex, 'subFields', newSubFields);\r\n        };\r\n\r\n        // Function to remove a sub-field\r\n        const removeSubField = (subIndex) => {\r\n            const newSubFields = subFields.filter((_, i) => i !== subIndex);\r\n            updateFieldProp(fieldIndex, 'subFields', newSubFields);\r\n        };\r\n        \r\n        // Function to render the settings for an individual sub-field\r\n        const renderSubFieldSettings = (subField, subIndex) => {\r\n            return createElement(\r\n                PanelBody,\r\n                { title: `${subField.label} (${subField.type})`, initialOpen: false, key: subIndex, className: 'repeater-sub-field-settings' },\r\n                createElement(TextControl, {\r\n                    label: \"Sub-Field Label\",\r\n                    value: subField.label,\r\n                    onChange: val => updateSubField(subIndex, 'label', val),\r\n                }),\r\n                createElement(TextControl, {\r\n                    label: \"Attribute Key (Variable Name)\",\r\n                    value: subField.key,\r\n                    help: \"Must be unique, lowercase, and contain only letters, numbers, and underscores.\",\r\n                    onChange: val => updateSubField(subIndex, 'key', val),\r\n                }),\r\n                createElement(SelectControl, {\r\n                    label: \"Sub-Field Type\",\r\n                    value: subField.type,\r\n                    options: FIELD_TYPES.map(t => ({ label: t.label, value: t.value })).filter(t => t.value !== 'repeater'),\r\n                    onChange: val => updateSubField(subIndex, 'type', val),\r\n                }),\r\n                createElement(Button, { \r\n                    isDestructive: true, \r\n                    onClick: () => removeSubField(subIndex),\r\n                    style: { marginTop: '10px' }\r\n                }, 'Delete Sub-Field')\r\n            );\r\n        };\r\n\r\n        return createElement(\r\n            PanelBody,\r\n            { title: 'Repeater Sub-Fields', initialOpen: true },\r\n            \r\n            // 1. Add New Sub-Field Palette\r\n            createElement('h4', null, 'Add New Sub-Field'),\r\n            createElement('div', { style: { display: 'flex', flexWrap: 'wrap', gap: '5px', marginBottom: '15px' } },\r\n                FIELD_TYPES.filter(t => t.value !== 'repeater' && t.value !== 'relational').map(type =>\r\n                    createElement(Button, { \r\n                        isSecondary: true, \r\n                        onClick: () => addSubField(type.value)\r\n                    }, type.label)\r\n                )\r\n            ),\r\n\r\n            // 2. List of Existing Sub-Fields\r\n            createElement('h4', null, `Current Sub-Fields (${subFields.length})`),\r\n            subFields.length > 0 ? \r\n                subFields.map((subField, subIndex) => renderSubFieldSettings(subField, subIndex)) :\r\n                createElement('p', null, 'No sub-fields defined. Add one above.')\r\n        );\r\n    };\r\n\r\n    // --- Render the Field Settings Panel ---\r\n    // const renderSettings = () => {\r\n    //     if (!selectedField) return <p>Select a field on the left to edit its properties.</p>;\r\n        \r\n    //     const index = fields.indexOf(selectedField);\r\n\r\n    //     return (\r\n    //         <Panel header=\"Field Settings\">\r\n    //             <PanelBody title={`Editing: ${selectedField.label} (${selectedField.type})`} initialOpen={true}>\r\n    //                 <TextControl\r\n    //                     label=\"Field Label\"\r\n    //                     value={selectedField.label}\r\n    //                     onChange={val => updateField(index, 'label', val)}\r\n    //                 />\r\n    //                 <TextControl\r\n    //                     label=\"Attribute Key (Variable Name)\"\r\n    //                     value={selectedField.key}\r\n    //                     help=\"Must be unique, lowercase, and contain only letters, numbers, and underscores.\"\r\n    //                     onChange={val => updateField(index, 'key', val)}\r\n    //                 />\r\n    //                 <TextControl\r\n    //                     label=\"Default Value (Optional)\"\r\n    //                     value={selectedField.default}\r\n    //                     onChange={val => updateField(index, 'default', val)}\r\n    //                 />\r\n    //                 <Button \r\n    //                     isDestructive \r\n    //                     onClick={() => removeField(index)} \r\n    //                     style={{marginTop: '10px'}}\r\n    //                 >\r\n    //                     Delete Field\r\n    //                 </Button>\r\n    //             </PanelBody>\r\n    //         </Panel>\r\n    //     );\r\n    // };\r\n    // --- Render the Field Settings Panel ---\r\n    const renderSettings = () => { // <--- THIS FUNCTION IS REPLACED\r\n        if (!selectedField) return <p>Select a field on the left to edit its properties.</p>;\r\n        \r\n        const index = fields.indexOf(selectedField);\r\n\r\n        return (\r\n            <Panel header=\"Field Settings\">\r\n                {/* Standard Settings (Label, Key, Default, Delete) */}\r\n                <PanelBody title={`Editing: ${selectedField.label} (${selectedField.type})`} initialOpen={true}>\r\n                    <TextControl\r\n                        label=\"Field Label\"\r\n                        value={selectedField.label}\r\n                        onChange={val => updateField(index, 'label', val)}\r\n                    />\r\n                    <TextControl\r\n                        label=\"Attribute Key (Variable Name)\"\r\n                        value={selectedField.key}\r\n                        help=\"Must be unique, lowercase, and contain only letters, numbers, and underscores.\"\r\n                        onChange={val => updateField(index, 'key', val)}\r\n                    />\r\n                    <TextControl\r\n                        label=\"Default Value (Optional)\"\r\n                        value={selectedField.default}\r\n                        onChange={val => updateField(index, 'default', val)}\r\n                    />\r\n                    <Button \r\n                        isDestructive \r\n                        onClick={() => removeField(index)} \r\n                        style={{marginTop: '10px'}}\r\n                    >\r\n                        Delete Field\r\n                    </Button>\r\n                </PanelBody>\r\n\r\n                {/* CONDITIONALLY RENDER REPEATER SUB-FIELDS SETTINGS */}\r\n                {selectedField.type === 'repeater' && \r\n                    renderRepeaterSettings(selectedField, index, updateField, removeField)\r\n                }\r\n            </Panel>\r\n        );\r\n    };\r\n\r\n\r\n    return createElement(\r\n        'div',\r\n        { style: { display: 'flex', gap: '20px', marginTop: '20px' } },\r\n        \r\n        // --- Left Column: Component Palette ---\r\n        createElement(\r\n            'div',\r\n            { style: { width: '20%', borderRight: '1px solid #ccc', paddingRight: '20px' } },\r\n            createElement('h3', null, 'Component Palette'),\r\n            FIELD_TYPES.map(type => \r\n                createElement(Button, { \r\n                    isSecondary: true, \r\n                    style: { display: 'block', width: '100%', marginBottom: '10px' },\r\n                    onClick: () => addField(type.value)\r\n                }, type.label)\r\n            )\r\n        ),\r\n        \r\n        // --- Middle Column: Component Structure (The Fields List) ---\r\n        createElement(\r\n            'div',\r\n            { style: { width: '40%' } },\r\n            createElement('h3', null, 'Block Structure'),\r\n            \r\n            // Render the list of fields\r\n            fields.map((field, index) => \r\n                createElement('div', { \r\n                    key: index, \r\n                    style: { \r\n                        padding: '10px', \r\n                        marginBottom: '8px', \r\n                        border: '1px solid #ddd',\r\n                        backgroundColor: selectedField === field ? '#eaf4ff' : '#fff',\r\n                        cursor: 'pointer'\r\n                    },\r\n                    onClick: () => setSelectedField(field)\r\n                }, \r\n                    `${field.label} (${field.type})`\r\n                )\r\n            ),\r\n            \r\n            createElement('hr', null),\r\n            \r\n            // Save Button and Messages\r\n            createElement(Button, { \r\n                isPrimary: true,\r\n                isBusy: isSaving,\r\n                onClick: handleSave,\r\n                disabled: isSaving\r\n            }, isSaving ? 'Saving...' : 'Save Structure & Regenerate Code'),\r\n\r\n            message && createElement('p', { style: { marginTop: '15px', fontWeight: 'bold' } }, message)\r\n        ),\r\n\r\n        // --- Right Column: Settings Panel ---\r\n        createElement(\r\n            'div',\r\n            { style: { width: '40%' } },\r\n            renderSettings()\r\n        )\r\n    );\r\n};\r\n\r\n \r\n// --- Render the application once the DOM is ready ---\r\njQuery(document).ready(function() {\r\n    const rootElement = document.getElementById('component-editor-root');\r\n    \r\n    // Check if the localized data object exists (blockFactoryEditorData)\r\n    if (rootElement && typeof blockFactoryEditorData !== 'undefined') { \r\n        wp.element.render(\r\n            createElement(ComponentEditorApp, { \r\n                // CRITICAL: Access the nested properties\r\n                initialConfig: blockFactoryEditorData.config, \r\n                blockSlug: blockFactoryEditorData.blockSlug \r\n            }),\r\n            rootElement\r\n        );\r\n    }\r\n});\r\n\r\n"],"names":["useState","useEffect","createElement","wp","element","Button","TextControl","Panel","PanelBody","SelectControl","components","FIELD_TYPES","label","value","slugifyKey","toLowerCase","replace","ComponentEditorApp","initialConfig","blockSlug","fields","setFields","isSaving","setIsSaving","selectedField","setSelectedField","message","setMessage","addField","type","newField","key","length","default","updateField","index","property","newFields","map","field","i","removeField","filter","_","handleSave","data","action","nonce","blockFactoryEditorData","block_slug","config_data","JSON","stringify","jQuery","post","ajaxurl","done","response","success","next_step","fail","always","renderRepeaterSettings","fieldIndex","updateFieldProp","removeFieldAtIndex","subFields","addSubField","newSubField","updateSubField","subIndex","newSubFields","subField","removeSubField","renderSubFieldSettings","title","initialOpen","className","onChange","val","help","options","t","isDestructive","onClick","style","marginTop","display","flexWrap","gap","marginBottom","isSecondary","renderSettings","indexOf","header","width","borderRight","paddingRight","padding","border","backgroundColor","cursor","isPrimary","isBusy","disabled","fontWeight","document","ready","rootElement","getElementById","render","config"],"ignoreList":[],"sourceRoot":""}